组织：中国互动出版网（http://www.china-pub.com/）
RFC文档中文翻译计划（http://www.china-pub.com/compters/emook/aboutemook.htm）
E-mail：ouyang@china-pub.com 
译者：李莉（daisylee  lili99@whu.edu.cn）
译文发布时间：2001-6-10
版权：本中文翻译文档版权归中国互动出版网所有。可以用于非商业用途自由转载，但必须
保留本文档的翻译及版权信息。


Network Working Group                                          D. Awduche
Request for Comments: 2702                                       J. Malcolm
Category: Informational                                           J. Agogbua
                                                               M. O'Dell
                                                               J. McManus
                                                     UUNET (MCI Worldcom)
                                                            September 1999



基于MPLS的流量工程要求
(RFC2702   Requirements for Traffic Engineering over MPLS)
 

本备忘录的状态
   	This memo provides information for the Internet community.  It does not specify an 
Internet standard of any kind.  Distribution of this	memo is unlimited.

版权声明
   Copyright (C) The Internet Society (1999).  All Rights Reserved.

摘要
本文档提出了基于多协议标记交换MPLS的流量工程的一系列要求。它对在MPLS域
方便实施高效可靠的网络运作的策略性能做了分析。这些策略可以用来优化网络资源利用，
增强面向流量的网络性能。

目录

1．	介绍
2．	流量工程
2.1	流量工程性能指标
2.2	流量与资源控制
2.3 现有IGP控制机制的局限性
3． MPLS和流量工程
	3.1 MPLS导图
	3.2 基于MPLS流量工程的基本问题
4．基于MPLS流量工程的增强功能
5．流量主干的属性和特征
	5.1 双向的流量主干
	5.2	对流量主干的基本操作
5.3 统计与性能监测
5.4 流量主干的基本属性
5.5 流量参数属性
5.6 通用路径选择与管理属性
5.6.1	通过网管指定的显式路由
5.6.2多重路径优先级别
5.6.3资源类别亲和属性
5.6.4适应性属性
5.6.5平行的流量主干之间的负载分配
	5.7	优先权属性
	5.8	抢占属性
	5.9	弹性属性
	5.10	策略属性
6.	资源属性
	6.1	最大分配因子
	6.2	资源等级属性
7．	约束路由
	7.1	约束路由的基本特征
	7.2	对具体实现的考虑
8．	小结
9．	对安全方面的考虑
10．参考文献
11．鸣谢
12．作者地址
13．版权声明


1．	介绍

MPLS [1,2] 集成了标记交换框架和网络层路由，基本的思路是在MPLS域入口节点处
根据转发等价类FEC（Forwarding Equivalence Classes）给数据报分配一个固定长度的短
标记，在整个MPLS域内，和数据报相捆绑的标记将决定数据报的转发，这时将不再考虑
数据报本来的报头。 
　　依据这个相对简单的规范，可以设计出一套有效的协议构架来解决当前Internet中区分
服务面临的许多关键问题。MPLS最重要的一项应用将是流量工程，这项应用的重要性已经
逐渐为大家所认识。[1,2,3] 
　　本文主要讨论了MPLS在流量工程方面的应用。本文的目的是提出在大型因特骨干网
上应用流量工程所需注意的问题和要求。我们希望MPLS的规范，或在此基础上的实现，
将会有助于实现这些目标。另外，我们还描述了MPLS实现所需的一些基本功能，以满足
流量工程的要求。
需要指出的是，尽管我们的讨论主要是基于Internet骨干网的，但是本文所描述的功能
同样适用于企业网上的流量工程。一般来说，这些功能可以被用在应用同一技术的任何标签
交换网络上，在这样的网络里，任何节点间至少有两条路径。
近期的一些文献研究了基于MPLS的流量工程和流量管理，其中较著名的有Li和
Rekhter的工作[3]，以及其他一些研究人员的研究。在[3]中，提出了一种利用MPLS和RSVP
在因特网上提供可扩展的区分服务及流量工程的框架。本文对上述类似的工作进行了补充。
它反映了作者管理大型因特骨干网的经验。

2．	流量工程

这一部分描述了在目前的因特网上的自治系统内的流量工程的一些基本的功能。并且提
出了目前的IGP在流量控制和资源控制方面的局限。这一节提出了MPLS的要求的必要性。
流量工程（TE）主要是优化运行网络的性能。一般来说，它包含了技术的应用、测量
的科学准则、模型化、归纳和因特网流量的控制，以及如何将这些知识和技术应用到实践中
来获取一些特定的性能指标。
流量工程的一个主要目的就是在促进有效、可靠的网络操作的同时，优化网络资源的利
用率和流量的性能。由于网络资源的昂贵和因特网激烈的商业竞争的本质，流量工程已经成
为大型自治系统中一个不可缺少的功能。这些事实都说明有必要最大限度的提高运行的效
率。

2.1	流量工程性能指标

流量工程的主要性能指标可以分为两种：
1．	面向流量 
2．	面向资源
面向流量的性能指标包括了增强流量QoS功能的各个方面。在单一QoS等级，尽力而
为的Internet流量模型中，面向流量的性能指标包括：对分组丢失的最小化、对时延的最小
化、对吞吐量的最大化以及对服务等级协定的增强等。在这一流量模型中，使分组丢失最小
化是最重要的性能指标。而在未来的区分服务的因特网中，一些与统计数据有关的面向流量
的性能指标（如时延峰值变化、丢失率等）也将会越来越重要。
面向资源的性能指标包括了优化资源利用的各个方面。高效的网络管理是达到面向资源
性能指标的重要途径。通常我们都希望能够确保在其他可选路径上还有可用资源时，一条路
径上的网络资源不会被过度的使用。带宽是当前网络上的一种非常重要的资源。因此，流量
工程的一项中心任务就是对带宽资源进行有效的管理。
无论是面向资源的还是面向流量的流量工程，它们首要的性能指标都是拥塞的最小化。
这里所关心的拥塞主要是长时间的拥塞，而不是由突发的流量所造成的短时间拥塞。发生拥
塞的情况主要有以下两种：
1．	当网络资源不足以满足负载的要求时所发生的拥塞。
2．	当业务流量与可用资源之间的映射效率不高时，导致一部分网络资源被过度使用，
而另一部分资源却未被充分利用时所造成的拥塞。
第一种类型的拥塞可以用以下方式解决：（1）对网络进行扩充，或（2）应用经典的拥
塞控制技术，或（3）同时使用以上两种方法。经典的拥塞控制技术是试图对业务请求进行
控制，从而保证业务能够和可使用的资源相匹配。用于拥塞控制的经典技术包括：速率控制、
窗口控制、路由器队列管理、流程控制以及一些其他的技术（见[8]以及它的参考文献）。
第二种类型的拥塞，即由于资源的不合理分配而引起的拥塞，通常可以用流量工程来解
决。
一般来说，不合理的资源分配所造成的拥塞都可以通过负载均衡来缓解。这类策略是通
过有效的资源分配，减轻拥塞或者是减少资源的使用，使得拥塞最小化，或资源利用率最大
化。当拥塞最小化时，将减少分组丢失，也将缩短传输时延，同时吞吐量将增大。这样，终
端用户所感觉到的服务质量将会有显著提升。
显然，负载均衡是优化网络性能的重要策略。然而，提供给流量工程的策略必须是足够
灵活的，以便网络管理员可以实现兼顾普遍成本结构和效用、税收模型的其他策略。

2.2	流量与资源控制

网络的性能优化本质上是一个控制的问题。在流量工程中，由一位流量工程师或一台控
制设备来充当一个自适应控制系统的控制者。该系统包括一系列相互连接的网络元素，一个
网络性能监测系统以及一整套网络配置与管理工具。流量工程师制定出一整套控制策略，利
用网络性能监测系统对网络的状态进项观察，然后对业务流量进行描述，最后通过控制措施
使网络达到与控制策略相符的、理想的状态。这一过程可以针对网络的现有状态实时进行，
或者，借助预报技术对网络状态的发展加以预测并采取相应的措施来提前进行。而后一种技
术可以提前避免网络产生不良状况。
理想情况下，上述控制措施应包括：
1．	对各种流量管理参数的修改，
2．	对与路由有关的参数的修改，
3．	对与资源有关的属性与约束条件的修改。
如果可能的话，流量工程的过程中应尽量避免手工参与。上述的控制措施可以以一种分
布式的，可扩展的方式自动完成。

2.3 现有IGP控制机制的局限性

这一小节阐述了IGP在流量工程方面的较为明显的局限性。
现有的因特网内部网关协议簇并没有提供流量工程的能力。因此，很难针对网络的性能
问题实现有效的策略。事实上，基于最短路径算法的IGPs是造成AS网络中的拥塞的主要
原因。最短路径算法是简单的基于附加值的优化算法。这些协议都是拓扑驱动的，因此它们
都不考虑网络可用的带宽和流量的特征。当出现以下情况时，就会发生拥塞：
1．	多个业务流的最短路径汇聚到一条特定的链路或者路由器接口上时，或
2．	某条业务流的最短路径将通过某条带宽不足以支持该业务的链路或接口时。
在这两种情况下，即使存在着拥有充足带宽的其他路径，拥塞仍然会发生。这种拥塞问
题（资源未合理分配的症状）正是流量工程所要避免的。对于第二种原因造成的拥塞，可以
用“等开销路径负载分摊”技术来解决，但是对于由第一种原因造成的拥塞，特别是对于拥
有复杂拓扑结构的大型网络，这种技术就没什么帮助。
目前，解决IGP协议簇的上述缺陷的较流行的方式是使用重叠模型技术，例如IP over 
ATM、IP over FR等。重叠模型在网络的物理拓扑结构上提供了一个自由的虚拟拓扑结构，
从而扩展了网络设计的空间。这种虚拟拓扑结构由虚电路构成，在IGP路由协议看来，这
些虚电路就相当于过去的物理链路。重叠模型还提供了许多其他重要的业务来支持流量与资
源控制，它们包括：（1）VC级的约束路由，（2）可由网络管理人员进行配置的显式路由，
（3）路径压缩，（4）呼叫允许控制功能，（5）流量整形和流量策略功能，以及（6）VC的
生存功能。依靠这些功能可以实现许多流量工程策略。例如，可以很容易的将过度使用的网
络资源上的业务流量转移到较为空闲的网络资源上。
对于大型网络来说，它所使用的MPLS必须拥有至少和重叠模型同样水平的功能。所幸，
这种功能在MPLS中可以较容易的实现。

3． MPLS和流量工程

这一节阐述了MPLS在流量工程上的应用。接下来的章节阐述了为了达到流量工程的
要求，MPLS所应具备的功能。
MPLS本身就具备了完成重叠模型所实现的各种流量工程功能的潜力。不同的是，它使
用的是集成模型，其成本与可扩展性较之重叠模型以及现有的其他同类技术都更为理想。同
样重要的是，它将有可能实现流量工程功能的自动化。这一点将有待进一步研究，它已经超
出了本文的范围。
关于术语的说明：在本文余下的部分将会广泛使用流量主干（traffic trunk）的概念。根
据Li和Rekhter[3]，流量主干是指被放在同一条标签交换路径的具有相同类型的业务流。
本质上，流量主干是某种特定的流量特征的抽象。将流量主干看作被路由的对象将会很有益
处，也就是说，流量主干经过的路径可以被改变。在这种意义上说，流量主干同ATM网和
帧中继网上的虚电路很相似。然而，我们必须强调，流量主干同它所经过的路径，也就是
LSP之间有着根本的区别。LSP是流量所经过的一个特定的标签交换路径。在实践中，术
语LSP是和流量主干当作同义语使用的。在5.0节中总结了本文所使用的流量主干的其他
特性。
MPLS的吸引人之处可以被归结为以下几点：（1）通过手工的网管配置或是下层协议的
自动配置，可以很容易的建立起不受传统逐跳路由协议限制的显式LSP，（2）LSP可以被
高效的维护，（3）流量主干可以被使用并被映射到LSP上，（4）可以给流量主干规定一套
属性来调整流量主干的行为，（5）可以给各种网络资源规定一套属性，以便对以上建立的
LSP通过的流量主干加以限制，（6）既可以对业务进行组合，也可以对业务进行分割，而
基于传统的路由协议的IP转发只支持对业务的组合，（7）可以较容易的实现“约束路由”，
（8）MPLS流量工程的开销要比其他的流量工程技术小的多。
另外，通过显式标签交换路径，MPLS可以在现有的Internet路由模型中实现准电路交
换功能。许多现有的关于基于MPLS的流量工程的建议都是着眼于建立显式的标签交换路
径。尽管它是流量工程的基本功能，但光有它并不足够。要实现大型网络的现有网络的性能
优化，流量工程技术还需要有其他功能。本文描述了其中一些必要的功能。

3.1 MPLS导图

这一小节介绍了“MPLS”导图的概念。它是MPLS流量工程的核心。MPLS导图类似
于重叠模型中的虚拟拓扑图。通过为流量主干选择LSP，MPLS导图被逻辑映射到物理网
络上。
一个MPLS导图包含一组LSR和LSP，LSR组成了MPLS导图中的节点，而LSP则
为LSR提供点到点的逻辑连接，从而充当MPLS导图的连接。我们有可能建立起基于标签
栈的概念的分层的MPLS导图（见[1]）。
MPLS导图之所以重要，是因为MPLS中的带宽管理的基本问题就是如何有效的将一
个MPLS导图映射到物理网络的拓扑图上。MPLS导图的抽象描述如下：
令G=（V，E，c）代表物理网络拓扑结构的图。这里，V是网络中一系列的点，而E
是一组连接：这就是说，对于V中的点v、w来说，如果v和w在G中直接相连，那么对
象（v，w）就在E中。 参数c是与E、V相关的一组带宽或者其他的约束条件。我们将用
G来指代基本的网络拓扑结构。
令H=（U，F，d）为MPLS导图，这里U是V的子集，它代表网络中的一组LSR，
或者更精确的说，它代表至少一条LSP的端点。F是指一组LSP，对于U中的x、y来说，
如果有一个LSP是以x、y为端点的，那么对象（x，y）就在集合F中。参数d是同F相
联系的一组要求和限制条件。显然，H是有向图。我们可以看出，H依赖于G的传递特性。

3.2 基于MPLS流量工程的基本问题

在MPLS上实现流量工程面临着下面三个基本问题：
?	如何将分组映射到转发等价类（FEC）上。
?	如何将转发等价类映射到流量主干上。
?	如何将流量主干映射到标记交换路经上。
尽管前两个问题非常重要，但本文并不是针对它们的。本文所关心的是第三种映射功能
的执行能力，通过这种映射使得网络操作既高效又可靠。这实际上就是将MPLS导图（H）
映射到基本网络拓扑结构（G）上的问题。

4．基于MPLS流量工程的增强功能

前一节讲述了目前网络上的流量工程的基本功能。同时也讨论了将MPLS用于流量工
程的可行性。 本文余下的章节将要描述为了充分支持在大型网络上的基于MPLS的流量工
程，MPLS所需要的功能。
它所需的功能包括：
1．	一组与流量主干相关，并对流量主干的行为特征进行描述的属性。
2．	一组与资源有关的属性，它们将对使用各种资源的流量主干进行限制。这些属性
也可以看作是一种拓扑属性的限制。
3．	“约束路由”。借助于这一技术与前面两点中的各种属性，MPLS将可以对流量主
干所选择的路径进行限制。另外，虽然约束路由技术只是MPLS技术的一项可选
功能，但是，它与MPLS应该能够紧密的结合在一起。
在通过网管活动或某种自动化技术驱使网络达到理想状态的过程中，与流量主干、资源
相关的一系列属性和与路由器相关的参数一起，构成了可以修改的全部控制参数。
在一个网络中，理想的情况是，网络操作者能够对上述参数进行动态的改变而无须中止
网络的操作。

5．流量主干的属性和特征

这一节描述了与流量主干相关的可以控制它们的行为的属性。
首先，流量主干的基本属性归纳如下：
（1）	流量主干是属于同一类的业务流的“汇集”。在某些情况下，我们可能希望放松
这种定义，以便流量主干可以包含多种类型的流量。
（2）	在一个单独的业务类型模型中，比如说目前的Internet网，流量主干可以封装
一对入口-出口LSR之间或一个子网的所有流量。
（3）	流量主干是可路由的对象（类似于ATM的虚拟电路）。
（4）	流量主干同它所经过的LSP有着明显的不同。在操作环境下，流量主干可以从
一条路经转移到另一条路径上。
（5）	流量主干是单向的
实际应用中，流量主干可以由其入口与出口LSR、它所映射到的转发等价类以及决定
其行为特征的一套属性来表示。
这里有两个问题非常重要：（1）流量主干的参数配置。（2）流量主干的路径选择与保
持规则。

5.1 双向的流量主干

尽管流量主干在概念上是单向的，但在很多实际情况下，在同一个端点同时初始化两个
相反方向的流量主干是非常有用的。一个主干，称为前向主干，载着流量从源点到终点。另
一个主干，称为后向主干，载着流量从终点到源点。在以下两个条件成立的情况下，我们称
这两个主干的汇集为双向流量主干（BIT）。
（1）	两个流量主干都是通过源点或网络管理站的原子操作初始化的。
（2）	两个流量主干必须同时存在。也就是说，它们同时初始化，同时被拆除。
BITs的拓扑特性也应当被考虑。一个BIT可以是拓扑对称的，也可以是拓扑非对称的。
如果组成BIT的流量主干是沿着同样的物理路径路由的，即使它们是沿着不同方向，我们就
说这个BIT是“拓扑对称”的。相反，如果组成BIT的流量主干是沿着不同的物理路径路
由的，那么这个BIT就是“拓扑非对称”的。
必须指出，双向的流量主干只是为了管理上的方便。在实践中，大部分的工程功能都可
以仅用单向流量主干来实现。

5.2	对流量主干的基本操作

对于流量工程来说，对其重要的基本操作归纳如下：
?	建立：建立一个流量主干。
?	激活：使一个流量主干开始传送流量。流量主干的建立与激活从逻辑上说是两个分
离            的事。然而，它们也可以作为一个原子操作来实现和发起。
?	去激活：是一个流量主干停止传送流量。
?	更改属性：使一条流量主干的属性发生改变。
?	重路由：使一条流量主干的路径发生改变。这一过程可以通过网管实现或下层协议
自动实现。
?	拆除：从网络中拆除一条流量主干并回收为其分配的所有网络资源。这些资源包括
标记空间、可用带宽等。
以上介绍的是流量主干上的基本操作。除此之外，还可能会有一些附加的操作，如流量
规划与流量整形等。

5.3 统计与性能监测

统计与性能监测功能对于网络的计费和流量特征描述功能来说是非常重要的。从统计与
性能监测系统上获得的统计数据将可以用于进行流量描述、性能优化、流量工程中的容量规
划等工作。
由于从流量主干上获得统计数据的能力的重要性，在MPLS的流量工程实现中，这一
功能是一项最基本的要求。

5.4 流量主干的基本属性

流量主干的属性是与一条流量主干相关并影响其行为特征的参数。
流量主干的属性可以通过网管明确的分配，也可以在MPLS域的入口LSR上，通过下
层协议对分组进行分类，并将它们映射到转发等价类上时，进行默认的分配。然而，不管这
些属性是如何分配的，为了达到流量工程的要求，应当能够通过网管对这些属性进行修改。
在流量主干的基本属性中，流量工程的实现有如下特别重要的基本属性：
?	流量参数属性
?	通用路径选择与管理属性
?	优先权属性
?	抢占属性
?	弹性属性
?	策略属性
流量参数与策略属性的组合类似于ATM网中的应用参数控制。上述属性中的大多数都
可以在现有的某种成熟技术中找到类似的概念。因此，将流量主干的属性映射到许多现有的
交换与路由机制上都将是十分简单的。
优先权和抢占属性可以看成是相关的属性，因为它们表示流量主干之间的相关性。因此，
这些相关性决定了在建立和维持路径的过程中，流量主干相互间的竞争网络资源的行为。

5.5 流量参数属性

我们可以用流量参数属性来获取要在流量主干中传输的流量的特征（更准确的说是转发
等价类）。这些特征包括峰值速率、平均速率、突发大小容许值等。从流量工程的角度来看，
流量参数之所以重要，是因为它们反映了流量主干的资源需求。它们对于使用预期策略来进
行资源分配与拥塞防止是十分有用的。
	从带宽分配来看，一个单独的所需带宽的规范值可以从流量主干的流量参数中计算出
来。执行这些计算的技术是众所周知的。其中一个例子就是有效带宽的理论。

5.6 通用路径选择与管理属性

通用路径选择与管理属性定义了为流量主干选择路径的规则以及维持已经建立的路径
的规则。
对路径的计算可以通过下层的协议自动完成或者是由网管来完成。如果某一流量主干没
有与之相关的资源要求或约束条件的话，则可以使用传统的拓扑驱动技术来进行路径选择。
然而，如果对流量主干有一定的要求或策略限制的话，在路径选择中就要使用约束路由技术
了。
在第7节中，我们描述了一个可以自动针对一系列的约束来计算路由的约束路由框架。
通过管理行为来确定显示路由的一些问题，我们将在下面的5.6节进行讨论。
路径管理将包括与保持流量主干流经的路径有关的所有问题。在某些情况下，可能希望
MPLS技术能够对自身进行动态的重新配置，以便能够适应网络状态的一些变化。
为了对路径的选择过程与管理过程加以控制，需要有一整套的各种属性。与流量主干的
路径选择与管理有关的基本属性和行为特征将在下一小节中描述。

5.6.1通过网管指定的显式路由

通过网管为流量主干指定的显式路由是指通过网络操作员的活动而进行配置的路径。通
过网管指定的显式路由可以是部分指定的或者是完全指定的。当只有一部分中间节点被指定
时，这条路径是部分指定的。在这种情况下，需要由下层协议来完成完整的路径。由于操作
上的错误，由网管指定的显式路由可以是矛盾的或是非法的。下层协议必须能察觉这些错误，
并提供正确的反馈，
由网管指定的显式路由应当具有一个“路径优先法则”属性。路径优先法则属性是一个
二进制变量，它表明一条根据管理要求指定的显式路由是“强制性”的还是“非强制性”的。
如果某一通过网管指定的显式路由的属性为“强制性”的话，那么有且只有这条路径能
被使用。如果一条强制路径是不可行的，或者这条路径由于缺乏足够的资源而不能被建立的
话，那么这条路径的建立过程就会失败。换句话说，如果一条路径被指定为强制性的话，那
么不管周围环境如何，都不能使用替代路径。一旦这条路径被建立起来，那么路径就不可能
改变，除非撤销路径或者建立一条新的路径。
但是，如果一条通过网管指定的显式路由是“非强制性”的话，那么在这条路径可用的
情况下，它将会被使用。否则，将由下层协议选择一条替代路径。

5.6.2多重路径优先级别

在一些情况下，可能需要通过网络管理活动为一个给定的流量主干指定多条候选的显式
路由，并为这些候选路由定义一套优先级。在路径建立的过程中，将依据优先级从候选路径
列表中选择合适的路径。当网络发生故障时，也将根据优先级从候选路径列表中选择一条替
代路径。

5.6.3资源类别亲和属性

	资源类别亲和属性用于确定某一流量主干在其路径上能够使用或者不能使用的网络资
源类别（参看第6节）。这些策略属性将对某一流量主干能够使用的路径做出进一步的限制。
某一流量的资源类别属性具有以下格式：
	〈资源类型，亲和性〉；〈资源类型，亲和性〉；…
	其中资源类型参数将表明一条流量主干的亲和属性的对象是哪一种资源类型；亲和属性
参数表明该流量主干与某一种资源的亲和关系，也就是说，在该流量主干流经的路径上是否
一定要使用或者一定不使用某一资源。特别地，亲和属性可能是一个二进制数，它具有下列
两者之一：（1）确定包含，和（2）确定排出。
	如果亲和属性是一个二进制数，那么它可能使用布尔表达式来指明某一流量主干的资源
类别亲和属性。
	如果某一流量主干没有资源类别亲和属性的话，则该流量主干与所有网络资源之间的亲
和关系是“无关”，那就是说，它对于是否一定要使用或者不使用某一类型的资源没有要求。
在实际应用中，这应当是默认的情况。
	资源类别亲和属性是一种非常有用而且非常强大的工具，使用这些属性可以实现许多流
量工程的策略。比如，可以使用这一属性将某些流量主干限定在网络某一特定的拓扑区域。
	对于具有某种资源类别亲和属性的流量主干，用约束路由的方法（参看第7节）为它计
算一条显示路由时，可以采用以下的方法：
1．	对于确定包含属性，在计算路径之前，删去所有不属于指定的资源类别的所有资
源。
2．	对于确定排除属性，在计算路径之前，删去所有属于指定的资源类别的所有资源。
	
5.6.4适应性属性

	随着时间的变化，网络的特征与状态也会发生变化。例如，产生了新的可以使用的资源，
发生故障的资源重新恢复正常，已分配的资源被释放等等。通常情况下，有时还会有更高效
的路径产生。因此，从流量工程的角度来看，需要有一些管理控制参数来规定流量主干对于
上述变化的反应。有些情况下，针对网络状态的变化，可能会希望能够对流量主干的路径进
行动态的变化，这种过程称为重新优化（re-optimization）。而在另外一些情况下，也可能不
希望进行这种重新优化。
	适应性属性是流量主干的路径保持参数的一部分。流量主干的这部分属性表明对某一流
量主干能否进行重新优化。适应性属性也可以使用一个二进制数来表示，它具有下列两者之
一：（1）允许重新优化，（2）禁止重新优化。
	当允许重新优化时，下层协议就可根据网络状态的改变（主要是资源可用性方面的改
变），将流量主干重新路由到不同的路径上。相反，如果是禁止重新优化，那么流量主干就
像被“钉”到这条路径上，是不可以根据网络状态的改变而进行重新路由的。
	当允许进行重新优化时，稳定性是一个主要的问题。为了保证稳定性，MPLS的实现方
案对于网络状态的变化不能过于敏感。同时，它也要具有足够的反应速度，以便最有效地利
用网络资源。这意味着，应当能够用网管手段对重新优化的频率进行配置与改变。
	还应当注意的是，重新优化是不同于弹性的。有一个不同的属性专门用来指明流量主干
的弹性特性（参看5.9节）。在实践中，如果允许流量主干重新优化，则意味着流量主干对
路径上的故障具有弹性恢复。然而，如果一条流量主干不允许重新优化，且它的路径并没有
被网管指明是“强制性”的，那么它也需要对路径上的链路和节点故障具有弹性恢复。
	正式地说，通过重新优化来适应网络状态的发展，意味着对故障具有弹性恢复，而对故
障具有弹性恢复，并不意味着是通过重新优化来对网络状态的改变进行适应。

5.6.5平行的流量主干之间的负载分配

在两个节点之间多条平行的流量主干上进行负载分配是一个十分重要的问题。在许多情
况下，可能两个节点之间的某一业务量无法只有任何一条单独的链路或路径来承担。然而，
该业务流量所需的资源可能低于网络中所有可用路径能够提供的总量。此时，唯一的方法是
将业务流量分解为一些流量子集，在将这些流量子集通过多条路径来加以传输。
在一个MPLS区域内，上述问题可以通过在两个节点之间发起多条流量主干来解决，
这样，总的业务量将可以分担到各条流量主干上。要实现这一过程，就必须要设计一种能够
对多条平行的流量主干灵活地进行负载分配的技术。
特别地，从操作的角度来看，如果允许有多条平行的流量主干存在，那么需要有某个属
性来表明每条流量主干所携带业务量的相对比例。下层协议将根据所指定的比例把负载映射
到流量主干上去。并且，最好能够维持属于相同宏流（相同源地址，目的地址和端口号）的
数据包之间的次序。

5.7	优先权属性
	
	优先权属性定义了流量主干之间的相对重要性。在MPLS的约束路由技术中，优先权
属性十分重要。利用这一属性可以决定连接建立与故障恢复过程中为流量主干进行路径选择
的顺序。
	在允许资源抢占的实现中，优先权属性也十分重要。使用这一属性可以为要实施抢先策
略的流量主干指定一定的顺序。

5.8	抢占属性
	
	抢占属性将决定一条流量主干能否抢占另一条流量主干的路径，或者是该流量主干的路
径能否为其他流量主干所抢占的性质。该属性对于实现面向流量的性能指标与面向资源的性
能指标都是十分重要的。在区分服务的环境中，抢占属性能够保证高优先级的流量主干总是
能够使用较为理想的路径。
	在故障处理过程中，可以使用抢占属性来实现许多具有优先级的恢复策略。
	抢占属性有以下4种模式：（1）允许抢占，（2）不允许抢占，（3）允许被抢占，(4)不
允许被抢占。 一条具有允许抢占属性的流量主干可以抢占一条具有允许被抢占的，低优先
级的流量主干。而一条具有不允许被抢占属性的流量主干是不允许被任何流量主干抢占的，
不管他们的相对优先权如何。一条具有允许被抢占属性的流量主干可以被比它优先权高的，
具有允许抢占的流量主干所抢占。
	值得注意的是，有些抢占模式是互斥的。使用上述的编号，任一给定的流量主干的可行
性的抢占模式组合可以是：（1，3），（1，4），（2，3）和（2，4）。其中（2，4）组合应该
是默认组合。
	只有当下列5个条件全都满足时，才可以说，一个流量主干“A”能够抢占另一个流量
主干“B”的路径：（1）A抢占优先级比B高，（2）B所使用的网络资源能够满足A的需要，
（3）按照某种判决标准，已经得出了网络资源不能同时满足A与B需求，（4）A具有允许
抢占的属性，（5）B具有允许被抢占的属性。
	虽然抢占属性是非常有用的，但是在现在尽最大努力的网络服务模式下，抢占属性不能
被认为是一个强制性的属性。然而，在区分服务环境中，抢占属性就变得非常有必要了。而
且，随着光纤互联网体系的出现，某些保护和存储功能可能需要从光纤层迁移到数据网络元
素中（像一些千兆和兆兆的标记交换路由器）以减少成本，这样就需要用到抢占策略以便在
发生故障的情况下，减少具有高优先权的流量主干的存储时间。

5.9	弹性属性
	
弹性属性决定了流量主干在发生故障时的行为特征。也就是说，当流量主干流经的路径
上发生故障时，需要解决以下几个基本问题：（1）故障检测，（2）故障通知，（3）链路复
原与业务恢复。很明显，MPLS的具体实现将需要具有解决上述问题的机制。
如果流量主干流经的路径发生了故障，那么可以为它们指定许多恢复策略，下面给出的
是一些可行策略的实例：
1．	不对流量主干重新进行路由选择。例如，具体实现中已经具有了某种保证生存性
的技术，这种技术能够保证当发生故障时，不必对流量主干进行重新选路就可以
确保业务继续进行。这种技术的一个例子是（当然还有其他很多技术存在），如果
在节点之间有多条平行的路径，根据某种控制策略，发生故障时，使得在一条LSP
失败后，其上的流量主干转移到其他的LSP上。
2．	将流量主干重新路由到具有充足资源的路径上。如果没有所需的路径的话，则不
进行重新路由。
3．	不再考虑各种资源约束参数，将流量主干重新路由到任意一条可用路径上。
4．	还有许多其他的解决策略，包括上述策略的一些组合形式。
一个“基本”弹性属性，决定了流量主干流经的路径发生故障时，所使用的恢复过程。
特别地，“基本”弹性属性是一个二进制数，它决定一条流量主干在发生故障时是否要进行
重新选路。“扩展”弹性属性用来决定发生故障时对流量主干的细节处理过程。比如说，扩
展的弹性属性可能规定发生故障时某一流量主干所能使用的一组替换路径，以及该组路径之
间的优先级关系。
弹性属性所控制的是MPLS与路由之间的相互作用过程。

5.10	策略属性

当某一流量主干不再符合路径建立时的约定时，也就是说，当某一流量主干的特性超过
了其流量参数所指定的数值时，由策略属性决定下层协议对其采取的处理方式。通常情况下，
策略属性表明对相应的违约流量主干是实施速率限制，做出标记，还是不做任何处理继续转
发。如果确实要使用某种策略的话，则可以直接使用一些已有的算法，如ATM论坛的
GCRA[11]来执行这一功能。
在许多场合下，是必须要有一定的策略机制，但是在另一些场合下，是不适合用策略机
制的。一般而言，是希望能够在网络的入口处实施一定的策略机制（以便符合SLA），而在
网络的核心则要尽力避免使用策略机制，除非容量的约束条件又明确的要求。
因此，从流量工程的角度来看，必须具有能够通过网管对每一条流量主干的流量策略机
制进行允许或禁止操作的能力。

6.	资源属性
	
	资源属性是拓扑状态属性的一部分，它们的作用是对特定资源上的流量主干选路过程加
以限制。

6.1	最大分配因子
	
某一资源的最大分配因子（MAM）是一个可以通过网管来进行配置的属性，它决定该
资源可以被流量主干所使用的比例。这里所说的资源最常用的就是带宽资源。然而，该资源
也可以是LSR上的缓冲资源。MAM的概念类似于帧中继或ATM网络中的预定与注册因子
（subscription and booking factors）。
对于MAM的选择可以使得某一资源处于不完全分配或过量分配两种状态。如果所有参
与某一资源分配的流量主干（可以由流量主干的流量参数来表述）的资源需求的总和不超过
该资源的总容量的话，则我们说对该资源的分配为不完全分配。如果参与某一资源分配的流
量主干的资源需求的总和超过该资源的总容量的话，则称对该资源的分配为过量分配。
 不完全分配可以用来限制资源的使用。然而，相对于电路交换，MPLS的环境更为复
杂，因为在MPLS环境下，一些数据流可以不考虑资源限制，根据传统的逐跳协议（也可
使用显示路由）来进行路由。
过量分配可以利用流量的统计特性以实现更有效的资源分配策略。特别地，当流量主干
的瞬时峰值的要求不重合时，适合使用过量分配。

6.2	资源等级属性

资源等级属性是由网管分配的参数，它表明资源的“等级”。资源等级的概念可以看作
是一种“颜色”的概念。可以这样认为，具有相同“颜色”的资源都属于相同等级。利用资
源等级属性，可以实现许多流量工程策略。这一属性最关心的资源是链路资源。链路资源的
等级属性是“链路状态”参数中很重要的一个方面。
资源等级属性是一个很有用的抽象概念。从流量工程的角度来看，可以使用这一属性来
实现许多与面向流量和面向资源的性能优化有关的策略。特别地，资源等级属性可以用于：
1．	可以为不在同一拓扑区域中的一组资源应用相同的策略。
2．	为一组建立流量主干路径所需的网络资源指定相互之间的优先级关系。
3．	将流量主干明确地限于一组特定的网络资源上。
4．	实现一组通用的包含/排出策略。
5．	增强本地流量包容策略。本地流量包容策略是指将本地流量限制在特定的网络拓
扑区域中的策略。
此外，资源等级属性还可以用于用户认证。
通常可以为某一资源分配多个网络资源属性。例如，可以为某一网络中所有的OC-48
链路分配某一种属性。此外，还可以给这些链路中属于某一网络区域的一部分链路再分配一
个属性，以便实现某种特定包容策略或者是以某种方式来配置该网络。

7．	约束路由

这部分讨论MPLS域内和约束路由有关的问题。在现在的术语中，约束路由常常是指
“QOS路由”[5,6,7,10]。本文使用“约束路由”这一名称是因为它能更好地体现这种技术
的本质，QOS路由只是这一技术的一个子集。
约束路由技术是一种命令驱动并具有资源预留能力的路由算法，它能够和现有的拓扑驱
动的，逐跳的Internet内部网关协议(IGP)共存。
一个约束路由框架利用下面的属性作为输入：
?	和流量主干有关的属性
?	和资源有关的属性
?	其他的拓扑状态信息
在上述信息的基础上，各个网络节点上的约束路由机制将对该节点上发起的每一条流量
主干自动地计算出一条显示路由。在这种情况下，每个流量主干的显示路由是一条详细的标
记交换路径，满足流量主干的需求条件，服从由资源可用性，管理策略和其他的拓扑状态信
息提出的各种约束。
一个约束路由技术可以极大的减少在流量工程策略实现中的手工配置和人工干预。
实际上，流量工程师或者是一个自动机将为一个流量主干指定端点，并为它分配一个属
性集，包含了流量主干的预期性能和行为特性。约束路由框架可以发现一个满足期望的可行
路径。如果必要，流量工程师或流量工程支持系统就能利用手工配置的显示路由来完成更好
的优化。

7.1	约束路由的基本特征

	一个约束路由至少应当具有这样一种能力，即自动地为流量主干建立一条可行路径的能
力。
	对于大多数约束路由参数来说，一般都认为要使用约束路由技术是非常困难的。然而，
在实践中，如果该路径存在，就可以用一种非常简单的，著名的启发式算法[9]来找到这条
可行路径：
?	首先，删除所有不能满足流量主干属性要求的资源；
?	其次，在剩下的拓扑图上使用最短路径算法。
	很明显，只要有可行的路径存在，使用上述简单的算法就可以找到这条路径。我们还可
用其他的规则来去除纠结（ties），对计算的结果进行进一步的优化。一般来说，去除纠结的
目的是为了是拥塞最小化。然而，如果有多条流量主干要同时进行路由计算的话，即使有可
行路径存在，上述算法也可能得不出结果。

7.2	对具体实现的考虑

	许多帧中继和ATM交换设备的商业实现已经可以支持一定的约束路由。对于这些设备
以及各种MPLS设备而言，为了满足MPLS的要求，对现有的约束路由进行扩展将是比较
简单的。
	而对于使用拓扑驱动、逐跳的IGP协议的路由器而言，要实现约束路由，至少可以采
用以下两种方法：
1．	对现有的IGP协议如OSPF, IS-IS协议等进行扩展，使之能够支持约束路由。现
在  正在努力提供这样的方法，比如对OSPF的扩展。[5,7]
2．	在每一个路由器中加上一个能够与现有的IGP协议共存的约束路由进程。这一方
法如图1所示：
          ----------------------------------------------------------
         |              管 理 接 口               |
          ---------------------------------------------------------
            |                 |                 |
     -------------------    ---------------------------   -----------------------
    |    MPLS    |<->|   约束路由进程   |  |  传统IGP进程  |
     -------------------    ---------------------------   -----------------------
                             |                     |
                -------------------------------------   -----------------------
               | 资源属性，可用性数据库  |  | 链路状态数据库 |
                -------------------------------------   -----------------------
图1  LSR中第三层的约束路由进程
	
在第三层上实现约束路由的过程，有许多重要的细节问题我们这儿没有讨论。这些包括：
?	在约束路由进程之间交换拓扑状态信息（如资源可用性信息，链路状态信息，资源
属性信息等）的机制
?	对拓扑状态信息进行维护的机制
?	约束路由进程与传统的IGP进程之间的互操作
?	满足流量主干适应性要求的机制
?	满足流量主干弹性与生存性的机制
总之，约束路由通过对满足流量主干的一套约束参数要求的可能路径的自动搜索，将大
大有助于对营运网的性能优化。它还能大大降低流量工程过程中的通过网管进行显示路径配
置的工作量和手工干预。

8．	小结

本文介绍了在MPLS上实施的流量工程的各种要求。还介绍了许多能够在Internet中
使用MPLS实现流量工程性能的功能。
应该指出的是，这里所提到的许多问题都可以通过下面的方法来解决，即，为MPLS
增加一些简单构件，随后利用一个高层的网络管理系统来对相应的功能加以扩展以便实现各
种要求。核心的MPLS规范不一定要包含约束路由功能。然而，为了满足性能需求，MPLS
和约束路由框架之间必须有一定的互操作能力。

9．	对安全方面的考虑

	本文档并没有介绍超出MPLS及使用相同机制的技术本身的一些新的安全问题，然而，
需要特别说明的是，通过网管对可配置的参数操作时要在一个安全的，经过认证的实体下进
行。

10．参考文献

   [1]  Rosen, E., Viswanathan, A. and R. Callon, "A Proposed
        Architecture for MPLS", Work in Progress.

   [2]  Callon, R., Doolan, P., Feldman, N., Fredette, A., Swallow, G.
        and A. Viswanathan, "A Framework for Multiprotocol Label
        Switching", Work in Progress.

   [3]  Li, T. and Y. Rekhter, "Provider Architecture for Differentiated
        Services and Traffic Engineering (PASTE)", RFC 2430, October
        1998.

   [4]  Rekhter, Y., Davie, B., Katz, D., Rosen, E. and  G. Swallow,
        "Cisco Systems' Tag Switching Architecture - Overview", RFC
        2105, February 1997.

   [5]  Zhang, Z., Sanchez, C., Salkewicz, B. and E. Crawley "Quality of
        Service Extensions to OSPF", Work in Progress.

   [6]  Crawley, E., Nair, F., Rajagopalan, B. and H. Sandick, "A
        Framework for QoS Based Routing in the Internet", RFC 2386,
        August 1998.

   [7]  Guerin, R., Kamat, S., Orda, A., Przygienda, T. and D. Williams,
        "QoS Routing Mechanisms and OSPF Extensions", RFC 2676, August
        1999.

   [8]  C. Yang and A. Reddy, "A Taxonomy for Congestion Control
        Algorithms in Packet Switching Networks," IEEE Network Magazine,
        Volume 9, Number 5, July/August 1995.

   [9]  W. Lee, M. Hluchyi, and P. Humblet, "Routing Subject to Quality
        of Service Constraints in Integrated Communication Networks,"
        IEEE Network, July 1995, pp 46-55.

   [10] ATM Forum, "Traffic Management Specification: Version 4.0" April
        1996.

11．鸣谢
	
	感谢Yakov Rekhter 对该文档草案的检阅，也感谢Louis Mamakos 和 Bill Barns 那
些帮助性的建议，以及Curtis Villamizar 的非常有价值的反馈意见。

12．作者地址

   Daniel O. Awduche
   UUNET (MCI Worldcom)
   3060 Williams Drive
   Fairfax, VA 22031

   Phone: +1 703-208-5277
   EMail: awduche@uu.net


   Joe Malcolm
   UUNET  (MCI Worldcom)
   3060 Williams Drive
   Fairfax, VA 22031

   Phone: +1 703-206-5895
   EMail: jmalcolm@uu.net


   Johnson Agogbua
   UUNET  (MCI Worldcom)
   3060 Williams Drive
   Fairfax, VA 22031

   Phone: +1 703-206-5794
   EMail: ja@uu.net


   Mike O'Dell
   UUNET  (MCI Worldcom)
   3060 Williams Drive
   Fairfax, VA 22031

   Phone: +1 703-206-5890
   EMail: mo@uu.net


   Jim McManus
   UUNET  (MCI Worldcom)
   3060 Williams Drive
   Fairfax, VA 22031

   Phone: +1 703-206-5607
   EMail: jmcmanus@uu.net


13．版权声明

   Copyright (C) The Internet Society (1999).  All Rights Reserved.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works.  However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.

   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assigns.

   This document and the information contained herein is provided on an
   "AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, 
INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION
   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

致谢

Funding for the RFC Editor function is currently provided by the Internet Society.
RFC2702   Requirements for Traffic Engineering over MPLS            基于MPLS的流量工程要求
RFC文档中文翻译计划                                                                      - 
1 -
